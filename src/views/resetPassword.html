<!DOCTYPE html>
<html>
<head>
    <title>Reset Your Password</title>
    <style>
        body { font-family: Cairo, sans-serif; }
        .container { width: 600px; margin: auto; padding: 20px; }
        .button { transition: all 0.2s; cursor: pointer; background-color: #b2ffeb; padding: 15px 25px; text-align: center; display: inline-block; border: none; border-radius: 5px; text-decoration: none }
        .button:hover { transition: all 0.2s; background-color: #b2ffea91; }
        .footer { margin-top: 20px; font-size: 1rem; text-align: center; color: #f1f1f1; }
        a { color: #000; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Reset Your Password</h1>
        <h2>Dear {{username}},</h2>
        <p>You requested to reset your password. Click the button below to proceed:</p>
        <a href="{{url}}"" class="button">Reset Password</a>
        <p>If you did not request a password reset, please ignore this email or contact support if you have concerns.</p>
        <div class="footer">
            <p>Thank you for using OnClick Academy!</p>
        </div>
    </div>
</body>
<script>
  // Import and configure the Firebase SDK
  // These scripts are required to initialize Firebase and Firebase Messaging
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js';
  import { getMessaging, getToken } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-messaging.js';

  // TODO: Replace the following with your app's Firebase project configuration
  // See: https://firebase.google.com/docs/web/setup#config-object
  const firebaseConfig = {
    apiKey: process.env.FIREBASE_API_KEY,
    authDomain: process.env.FIREBASE_AUTH_DOMAIN,
    projectId: process.env.FIREBASE_PROJECT_ID,
    storageBucket: process.env.FIREBASE_STORAGE_BUCKET,
    messagingSenderId: process.env.FIREBASE_MESSAGING_SENDER_ID,
    appId: process.env.FIREBASE_APP_ID,
    measurementId: process.env.FIREBASE_MEASUREMENT_ID
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const messaging = getMessaging(app);

  // Request permission and get token
  function requestPermissionAndGetToken() {
    Notification.requestPermission().then((permission) => {
      if (permission === 'granted') {
        console.log('Notification permission granted.');

        // Get token
        getToken(messaging, { vapidKey: process.env.FIREBASE_VAPID_KEY }).then((currentToken) => {
          if (currentToken) {
            console.log('FCM Token:', currentToken);
            // Send the token to your server and update the UI if necessary
            // ...
          } else {
            console.log('No registration token available. Request permission to generate one.');
            // Show permission UI or make a note that the user doesn't want to be notified
          }
        }).catch((err) => {
          console.error('An error occurred while retrieving token. ', err);
          // Handle error cases
        });
      } else {
        console.log('Unable to get permission to notify.');
        // Handle cases where the user denies notification permission
      }
    });
  }

  // Call the function to get the FCM client token
  requestPermissionAndGetToken();
</script>
</html>
